/*
 rad_liquid_slideshow-1.0.0.js
 Copyright (c) 2014 Rakuten.Inc
 Date : 2014-07-10 17:22:37
*/
(function(n,o){function i(e){var a=e.css("cssText");null==a&&(a="");e.css("cssText",a+"; display:none!important;")}if(n.jQuery!==o){jQuery.noConflict();var g=jQuery;if(g.RJS_Helpers&&g().RJS_Slideshow){var p=function(e){var a=this;g.extend(a,{slideshow:null,settings:{rjs:{maxitem:[3,"Int","^[1-9]$"],pagespeed:[100,"Range","0,9999"],opacityspeed:[100,"Range","0,9999"],autoslidetime:[2,"Range","1,10000"],autoslideflag:["next","Str","^(next|prev)$"],autoslide:[0,"Int","^[0-1]$"],autoresize:[1,"Int",
"^[0-1]$"],verticalmode:[0,"Int","^[0-1]$"],indicator:[0,"Int","^[0-1]$"],indicatoralign:[0,"Int","^[0-1]$"]},common:{url:["","Str","^https?://(?:[a-zA-Z0-9\\-]+\\.)+rakuten\\.co\\.jp/[a-zA-Z0-9!~_&='\\(\\)\\*\\?\\-\\.%/]+$"],maxcount:[1E3,"Range","1,10000"],ajaxtimer:[99,"Range","1,99"],pagenumber:[0,"Int","^[0-1]$"],sid:["","Str","^[a-zA-Z0-9_\\-]{3,64}$"],impvar:["","Str","^[a-zA-Z0-9_]{3,64}$"],impdisp:["","Str","^[a-zA-Z0-9_]{3,64}$"],impnodisp:["","Str","^[a-zA-Z0-9_]{3,64}$"]},rad:{blankimageurl:["http://a.ichiba.jp.rakuten-static.com/com/img/home/t.gif",
"Str",".*"],textnum:[1,"Range","1,9999"],imagenum:[1,"Range","1,9999"],iconnum:[1,"Range","1,9999"],shopnum:[1,"Range","1,9999"],textlinenum:[1,"Range","1,9999"]}},eobj:{reco:{config:e.find(".rad-slideshow-config"),prevButton:e.find(".rad-slideshow-prev"),nextButton:e.find(".rad-slideshow-next"),proto:e.find(".rad-slideshow-proto"),frame:e.find(".rad-slideshow-frame"),existItem:e,itemsDisplay:e.find(".rad-slideshow-body"),altContents:e.find(".rad-slideshow-alteredContents"),loadingContents:e.find(".rad-slideshow-loading"),
indicatorDisplay:e.find(".rad-slideshow-indicatorArea"),nowPage:e.find(".rad-slideshow-nowPage"),maxPage:e.find(".rad-slideshow-maxPage"),backButton:e.find(".rad-slideshow-back")},indicator:{proto:e.find(".rad-slideshow-indicatorProto")}},props:{reco:{items:[],proto:{html:"",height:0,width:0,identifiers:{text:["","#TEXT$1L$2#",""],texturl:["","#TEXTURL$1#",""],image:['<img src="',"#IMAGE$1#",'" alt="#IMAGEALT$1#">'],imageurl:["","#IMAGEURL$1#",""],imagealt:["","#IMAGEALT$1#",""],icon:['<img src="',
"#ICON$1#",'" alt="#ICONALT$1#">'],iconurl:["","#ICONURL$1#",""],iconalt:["","#ICONALT$1#",""],shop:["","#SHOP$1#",""],shopurl:["","#SHOPURL$1#",""]}}},indicator:{proto:{html:"",width:0,height:0}}},multiplyPlaceholders:function(){var c,d,b,e,k,l,g,f,j,h,m;l=a.props.reco.proto.identifiers;g=["text","image","icon","shop"];d=a.settings.rad.textlinenum;var i=function(a,b,c){b+=1;return"number"==typeof c?(c+=1,[a[0].replace("$1",b).replace("$2",c),RegExp(a[1].replace("$1",b).replace("$2",c),"g"),a[2].replace("$1",
b).replace("$2",c)]):[a[0].replace("$1",b),RegExp(a[1].replace("$1",b),"g"),a[2].replace("$1",b)]};for(k in g){f=g[k];c=a.settings.rad[f+"num"];j=l[f];h=l[f+"url"];m=l[f+"alt"];if("text"==f)for(b=0;c>b;b++)for(e=0;d>e;e++)l[f+b+"l"+e]=i(j,b,e);else for(b=0;c>b;b++)l[f+b]=i(j,b);delete a.props.reco.proto.identifiers[f];for(b=0;c>b;b++)l[f+"url"+b]=i(h,b);delete a.props.reco.proto.identifiers[f+"url"];if(m){for(b=0;c>b;b++)l[f+"alt"+b]=i(m,b);delete a.props.reco.proto.identifiers[f+"alt"]}}},loadSettings:function(){i(a.eobj.reco.proto);
if(1>a.eobj.reco.config.size())return!1;a.settings.rjs=g.RJS_Helpers.readAttr(a.eobj.reco.config,a.settings.rjs);a.settings.common=g.RJS_Helpers.readAttr(a.eobj.reco.config,a.settings.common);a.settings.rad=g.RJS_Helpers.readAttr(a.eobj.reco.config,a.settings.rad);if(""==a.settings.common.url||512<a.settings.common.url.length||0===a.eobj.reco.proto.length)return!1;a.eobj.reco.config.remove();return!0},initialize:function(){a.loadSettings()&&(a.multiplyPlaceholders(),g(function(){g.ajax({url:a.settings.common.url,
cache:!1,dataType:"jsonp",scriptCharset:"utf-8",timeout:1E3*a.settings.common.ajaxtimer,success:a.prepareData,error:function(){}})}))},prepareData:function(c){if(!c||!c.adList)return!1;if(0==c.adList.length)return a.regImpressionCode(a.settings.common.impnodisp),!1;var d=c.adList,c=d.length;if(c>a.settings.common.maxcount)c=a.settings.common.maxcount;d.length=c;d=a.validateRadData(d);a.props.reco.items=d;a.props.recoItemNum=c;return a.displayData(a.props,a.eobj,a.settings.rjs)},validateRadData:function(c){var d=
[],b,e,k,g,i,f,j,h;g=c.length;for(k=0;g>k;k++){f={};i=c[k];j=i.text;for(b=0;a.settings.rad.textnum>b;b++){h=j[b]||{value:[],url:""};var m=h.value;for(e=0;a.settings.rad.textlinenum>e;e++)m[e]=m[e]||"",f["text"+b+"l"+e]=m[e];f["texturl"+b]=a.addSID(h.url)}j=i.image;for(b=0;a.settings.rad.imagenum>b;b++)h=j[b]||{value:a.settings.rad.blankimageurl,url:"",alt:""},f["image"+b]=h.value,f["imageurl"+b]=a.addSID(h.url),f["imagealt"+b]=h.alt;j=i.icon;for(b=0;a.settings.rad.iconnum>b;b++)h=j[b]||{value:a.settings.rad.blankimageurl,
url:"",alt:""},f["icon"+b]=h.value,f["iconurl"+b]=a.addSID(h.url),f["iconalt"+b]=h.alt;j=i.shop;for(b=0;a.settings.rad.shopnum>b;b++)h=j[b]||{value:"",url:""},f["shop"+b]=h.value,f["shopurl"+b]=a.addSID(h.url);d[k]=f}return d},displayData:function(c,d,b){if(0===d.reco.proto.length)return!1;c.reco.proto.width=d.reco.proto.outerWidth();if(0==c.reco.proto.width)c.reco.proto.width=d.reco.proto.css("width").replace("px","");c.reco.proto.height=d.reco.proto.outerHeight();c.reco.proto.html=d.reco.proto.html();
if(""==c.reco.proto.html)return!1;i(d.reco.proto);d.reco.itemsDisplay.empty();if(b.indicator){if(0===d.indicator.proto.length)return!1;c.indicator.proto.width=d.indicator.proto.outerWidth();if(0==c.indicator.proto.width)c.indicator.proto.width=d.indicator.proto.css("width").replace("px","");c.indicator.proto.height=d.indicator.proto.outerHeight();c.indicator.proto.html=d.indicator.proto.html();if(""==c.indicator.proto.html)return!1;i(d.indicator.proto);d.reco.indicatorDisplay.empty()}i(d.reco.altContents);
a.eobj.reco.loadingContents.show();a.eobj.reco.existItem.show();d.reco.itemsDisplay.RJS_Slideshow(a,{settings:b,itemPrototype:c.reco.proto,indicatorPrototype:c.indicator.proto,eobj:d.reco,items:c.reco.items,events:{beforeFirstRender:function(a,b){b.eobj.reco.prevButton.show();b.eobj.reco.nextButton.show()},afterFirstRender:function(a,b){b.eobj.reco.loadingContents.hide();b.eobj.reco.existItem.show();b.eobj.reco.itemsDisplay.show();b.eobj.reco.frame.show()},changePageNumber:1==a.settings.common.pagenumber?
a.changePageNumber:!1}});a.regImpressionCode(a.settings.common.impdisp);a.eobj.reco.backButton.click(function(b){b.preventDefault();a.slideshow.changePage(1);return!1})},addSID:function(c){var d=a.settings.common.sid;""!==c&&""!==d&&(c+=(0<=c.indexOf("?")?"&":"?")+"ap=s-id%3D"+d);return c},regImpressionCode:function(c){return n[a.settings.common.impvar]===o||""==c?"":n[a.settings.common.impvar]=c},changePageNumber:function(a,d,b){b.eobj.reco.nowPage.text(a);b.eobj.reco.maxPage.text(d);1==a?b.eobj.reco.backButton.hide():
b.eobj.reco.backButton.show()}})};g("div.rad-slideshow-existItemDisplay").each(function(){(new p(g(this))).initialize()})}}})(this);
